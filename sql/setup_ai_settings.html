
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>תיקון הגדרות AI (SQL Update)</title>
    <style>body{font-family:sans-serif;background:#f0f9ff;padding:40px;color:#0c4a6e}.container{max-width:800px;margin:0 auto;background:white;padding:30px;border-radius:12px;border:1px solid #bae6fd}textarea{width:100%;height:250px;background:#0f172a;color:#38bdf8;padding:15px;border-radius:8px;direction:ltr}button{background:#0284c7;color:white;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;margin-top:10px;font-weight:bold}</style>
</head>
<body>
    <div class="container">
        <h1>תיקון והוספת הגדרות AI למסד הנתונים</h1>
        <p>הרץ סקריפט זה ב-Supabase SQL Editor כדי לתקן את השגיאה <code>Could not find the 'ai_custom_prompt' column</code>.</p>
        <textarea id="sql" readonly>
BEGIN;

-- 1. Ensure API Key column exists
ALTER TABLE app_settings ADD COLUMN IF NOT EXISTS gemini_api_key TEXT;

-- 2. Ensure Custom Prompt column exists
ALTER TABLE app_settings ADD COLUMN IF NOT EXISTS ai_custom_prompt TEXT DEFAULT NULL;

-- 3. Ensure Keywords column exists
ALTER TABLE app_settings ADD COLUMN IF NOT EXISTS ai_keywords JSONB DEFAULT '[]'::jsonb;

-- 4. Critical: Refresh Supabase Schema Cache
NOTIFY pgrst, 'reload schema';

COMMIT;
        </textarea>
        <button onclick="navigator.clipboard.writeText(document.getElementById('sql').value)">העתק קוד</button>
    </div>
</body>
</html>
